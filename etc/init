# This will be sourced before launching a Singularity container.

# Environment modules if set, cause errors in containers
unset module

# Some distributions don't have /bin and /sbin in PATH anymore
PATH="/bin:/sbin:/usr/bin:/usr/sbin:$PATH"

# Don't save the shell's HISTFILE
HISTFILE="/dev/null"

export PATH HISTFILE

# Conditionally disable the PID namespace if we are invoked via OMPI or SLURM
if [ -n "$OMPI_COMM_WORLD_SIZE" ]; then
    SINGULARITY_NO_NAMESPACE_PID=1
    export SINGULARITY_NO_NAMESPACE_PID
fi
if [ -n "$SLURM_JOB_ID" ]; then
    SINGULARITY_NO_NAMESPACE_PID=1
    export SINGULARITY_NO_NAMESPACE_PID
fi
